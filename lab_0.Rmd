---
title: "Lab 0"
description: |
  Biostatistics & Epi, Lab 0 - GLHLTH 705
date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Lab 0 Goals:

By the end of this lab, you will have demonstrated a basic familiarity with the R coding environment and R Markdown files. You will be able to:

* Start a new project and import data
* Understand useful R terminology
* Use summary statistics to describe the Kenya dataset
* Create a categorical variable using a continuous one
* Generate histograms and boxplots using ggplot2
* Create a simple cross-tabulation of two variables

# Task 1: Establish a workflow

In R, we organize our work by projects. It is best practice to keep no more than one project in any single folder on your computer. First, we should establish the file folders from which we'll be working. 

## Create folders to store your work

If you haven't already, now would be a good time to: 

1. Create a new folder on your computer called "705 Lab".

2. Within that folder, create a folder for this lab, called "Lab 0".

3. Finally, within that folder, create a folder for your data, called "data"

4. Save the dataset titled Lab_0_kenya.rds (from Sakai) into the folder called "data"

__Please make this a habit. We will expect you to do this for every lab, as it will keep your work organized and will keep *you* happy.__

## Create a New Project in RStudio

Now open RStudio and take a deep breath. Don't panic. This will all be very familiar in a few short months from now. 

Initiate a new project by going to *File* and clicking *New Project*. 

TODO: INSERT SCREENSHOT

Then select *Existing Directory* and hit *Browse*. Navigate to the folder titled __Lab 0__. Open it, then hit *Open*. 

# Task 2: Familiarize yourself with R Markdown

Now, you will open a special kind of document known as "R Markdown". This is a text editor (like Word or Google Docs), but with a twist. You can run code *within the document*. This makes data analysis an interactive, iterative (and therefore fun?) process that usually goes:

  1. Write some code intended to transform your data
  2. Run the code
  3. Observe how your dataset behaved
  4. (Optional) Take a few notes
  5. Tweak code
  6. Repeat
  
For each lab, we will provide you with a skeleton Markdown file on Sakai. If you haven't already, download that file ("lab0_705_fall2021.Rmd") and save it to your folder called "Lab 0".

Now open the file in RStudio. You can just double-click on it from the file folder. It will appear, but might feel a little pinched. Luckily, RStudio allows Markdowns to pop-out. 

Click the white square at the top of the file that I've circled in the photo below to do just that:

![Pop-out](images/popout.png)


# Task 3: Load packages and data

## Installing packages

Packages are collections of functions. As we'll see shortly, we use functions as code to view, manipulate, and analyze our data. 

There are packages that come built-in with R. These have names like {base}, {utils}, and {stats}.

Since R is open-source, users are able to create their own packages so that other R users can use them. These packages are available in places like [the Comprehensive R Archive Network (CRAN for short)](https://cran.r-project.org/web/packages/) and [GitHub](https://github.com/).

Lucky for us, packages are easily retrieved from the command line. If you haven't already, run the following code from your console to download the packages that we'll be needing for this semester:


```{r eval = FALSE, echo = TRUE}
install.packages("tidyverse")
install.packages("skimr")
install.packages("epiR")
install.packages("devtools")
devtools::install_github("potato-nathan/epiAssist")
```


## Load libraries

To enable R to use a package's functions in our current project environment, we need to load the packages using `library()`

In a fresh code chunk, call in the {tidyverse} and {skimr} packages using the following code:

```{r}
library(tidyverse)
library(skimr)
```

__Notice that when we install packages, we need to specify their names using quotes, but when we load them into R using `library()`, R recognizes them as package objects automatically. You can surround them with quotes and it will load all the same. 


## Task 4: Load data

You will use the dataset kenya_dhs_dataset_lab_0.rds for this lab. Save the kenya_dhs_dataset_lab_0.rds dataset from SAKAI into the same folder as your New Project.  Use command readRDS(‘filename.rds’) to load in the dataset. Don’t forget to use the assignment operator to give the dataset a name after importing the data. As an example, you can name it like this:

`kenya <- file name` 




## Task 5: Explore the dataframe

Familiarize yourself with the data by using the commands `head()`, `length()`, `skim()`, and `nrow()`.

* Are there any string/character variables?
* Are there any variable or value labels? 
* Do any variables have notes? 




## Task 6: Create variable mage

Create a variable mage for mother’s age (as an integer) at the time of each child’s birth (note – some of these mothers have had multiple children) using the `mutate()` function. This is calculated from variables b3 (month code of child’s birth) and v011 (month code of mother’s birth). The difference between the values of these variables is months, so divide by 12 to get years. See the data dictionary for a more detailed description of month codes and how to use them. Use the `as.integer()` function within your `mutate()` function to truncate the calculated value to an integer.

REMINDER: For your mutate function to work, you have to merge the changes into your dataset. As an example, use this before the mutate function:
`kenya <- kenya %>%` 


## Task 7: Frequency distributions of mage

Suppose you want to break down mage into three categories. First, look at the frequency distribution (one-way frequency table) for mage to see where you might draw lines for your categories using the table() command.

* Are there any missing values for age? If so, how many?
* Which range of ages appear the most frequently in mage?



## Task 8: Create variable magec

Using mage, generate a new variable with three categories: <18, 18-39, and ≥ 40, naming the new variable “magec” (mother’s age categorical). Set the values for magec to be 0,1,2, where 0 corresponds to the youngest age group (<18).
Recommended steps:

* First, don't forget to use the assignment operator to save your changes to the kenya dataframe.
* Then, use `mutate()`  to create a new variable, magec, 
* within your `mutate()` command, use `case_when()` to create a series of conditional statements that assigns number 0, 1, and 2 to each category 
* on a new line of code, use `factor()` to assign labels to each level of your new variable
*	Variable Label: “Age in years categorized” 
*	Values: 
  + 0:  <18 
  + 1:	18-39
  + 2:  ≥ 40



## Task 9: Cross-tab of mage and magec

Look at a cross-tabulation (two-way table) of mage and magec to ensure that magec was created correctly. Be sure missing values were handled properly (all observations that have a missing value for mage should be assigned the R missing value “NA” for magec.).   Type “?table” for help with how to create a 2x2 table.  Note: the order of the variables in the command controls which one is in the rows and which is in the columns of the table. Experiment to make your table readable.




## Task 10: Save new dataset

Save the new dataset in the same directory using a different file name with the form shown in the instructions on page 1 using the saveRDS() command.







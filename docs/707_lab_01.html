<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { color: #585cf6; } /* Constant */
code span.co { color: #4c886b; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.dv { color: #0000cd; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cd; } /* Float */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { color: #687687; } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #036a07; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>DGHI/Biostat Lab: Lab 1 (707)</title>

  <meta property="description" itemprop="description" content="__Due:__ February 25, 2022 by 14:00 ET"/>

  <link rel="icon" type="image/vnd.microsoft.icon" href="images/favicon.ico"/>

  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-05-31"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-05-31"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="DGHI/Biostat Lab: Lab 1 (707)"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="__Due:__ February 25, 2022 by 14:00 ET"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="DGHI/Biostat Lab"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="DGHI/Biostat Lab: Lab 1 (707)"/>
  <meta property="twitter:description" content="__Due:__ February 25, 2022 by 14:00 ET"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Lab 1 (707)"]},{"type":"character","attributes":{},"value":["__Due:__ February 25, 2022 by 14:00 ET\n"]},{"type":"character","attributes":{},"value":["2022-05-31"]},{"type":"character","attributes":{},"value":["distill::distill_article"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
          var fn = $(this).children()[0]
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">
  /* base(d!) variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */

  @import url('https://fonts.googleapis.com/css2?family=Libre+Baskerville&family=Source+Sans+Pro:wght@500&display=swap');


  @import url('https://fonts.googleapis.com/css2?family=Lato&family=Roboto+Slab&display=swap');
  @import url('https://fonts.googleapis.com/css2?family=Amiri');
  @import url('https://fonts.googleapis.com/css2?family=Bitter');
  @import url('https://fonts.googleapis.com/css2?family=DM+Mono');
  @import url('https://fonts.googleapis.com/css2?family=Lato&family=Roboto+Slab&display=swap');
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    "Libre Baskerville", serif;
    --footer-font:     "Source Sans Pro", serif;
    --mono-font:       "DM Mono", monospace;
    --body-font:       "Source Sans Pro", sans-serif;
    --navbar-font:     "Libre Baskerville", serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   #253559;
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       21px;    
    --text-color:       #FFFFFF;
    --text-size:        17px;
    --hover-color:      #8A009D; 
    --bkgd-color:       #009D8A;
  }


  .distill-site-footer {
    --text-color:       #FFFFFF;
    --text-size:        15px;
    --hover-color:      #9D0061;
    --bkgd-color:       #999999;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */

  /*Spoiler alert text
  usage--
  text turns white:
  <span class="spoiler" >test</span>

  background turns transparent:
  <span class="spoiler2"> other test </span>

  */

  .spoiler, .spoiler2{ 
    color:              black; 
    background-color:   black;
  }

  .spoiler:hover{
    color: white;
    }

  .spoiler2:hover { 
    background-color:white; 
    }

  /* Altering the monospace properties so that all monospace has a grey background and is slightly bolded */

  code {
    font-family: 'Fira Code', monospace;
  color: #3C009D; 
  background: #DEDEDE;

  /*background: #b3daf1; */
    font-weight: 500;
    font-size: 1em;
  }

  /* Change bullets */
  ul > li::marker {
    font-size: 1.125em;
    color: #2f588d;
  }

  /* Change link appearance */
  d-article a {
    border-bottom: 2px solid #9D0061;
    text-decoration: none;
  }

  d-article a:hover{
    background-color: #9D0061 ;
    color: #FFFFFF;
  }

  /* following are custom settings to make the cat image as tall as the navbar */
  *.distill-site-header .logo img {
      display: inline-block;
      width: 60px;
      height: 60px;
      max-height: 60px;
  }

  .distill-site-header {
      height: 60px;
  }


  .distill-site-header .title {
  position: relative;
  transform: translateY(-30%);
  } 

  .distill-site-header .nav-right {
      top: 10%;
      position: relative;
  }

  d-title{
    margin-top: 50px;
  }

  /* Collapsible section headers */
  /* https://developer.mozilla.org/en-US/docs/Web/HTML/Element/details#customizing_the_disclosure_widget */

  /*details.section-head {
    width: 620px;
    font-size: 30px;
    list-style-type: disc;
  }

  details.section-head > summary {
    /*font-size: 30px;*/
  }

  /*details[open] > summary {
    color: #ededed;  
  }

  details[open] > summary > code {
    color: #ededed;
    background: #ededed;
  }

  details[open]{
    background-color: #ededed;
    border-radius: 10px 10px 10px 10px;
    padding: 2px 10px;
  } 

  details.section-head > p {
    font-size: 1.06rem;
  }

  details.section-head > ul > li {
    font-size: 1.06rem;
  }

  details.section-head > h1 {
    font-size: 30px;
  }

  details.section-head > details {
    font-size: 1.10rem;
  }*/</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="site_libs/clipboard-2.0.6/clipboard.min.js"></script>
  <link href="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.css" rel="stylesheet" />
  <script src="site_libs/xaringanExtra-clipboard-0.2.6/xaringanExtra-clipboard.js"></script>
  <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Lab 1 (707)","description":"__Due:__ February 25, 2022 by 14:00 ET","authors":[],"publishedDate":"2022-05-31T00:00:00.000-04:00"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://pngtree.com/so/llama">
<img src="images/narwhal.png" alt="Logo"/>
</a>
<a href="index.html" class="title">DGHI/Biostat Lab</a>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
Help With
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="help_rstudio.html">Using RStudio</a>
<a href="help_projects.html">Starting a new project</a>
<a href="help_packages.html">Working with packages</a>
<a href="help_jargon.html">jaRgon</a>
<a href="help_ggplot2.html">Visualizing in R (ggplot2)</a>
<a href="broken.html">Broken Code</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Lab Assignments
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<span class="nav-dropdown-header">705 Labs</span>
<a href="705_lab_0.html">Lab 0</a>
<a href="705_lab_1.html">Lab 1</a>
<a href="705_lab_2.html">Lab 2</a>
<a href="705_lab_3.html">Lab 3</a>
<a href="705_lab_4.html">Lab 4</a>
<hr/>
<span class="nav-dropdown-header">707 Labs</span>
<a href="707_lab_01.html">Lab 1</a>
<a href="707_lab_02_03.html">Lab 2 &amp; 3</a>
<a href="707_lab_04.html">Lab 4</a>
</div>
</div>
<a href="submit.html">Submission Guidelines</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Dictionaries
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="fun_dict.html">Function Dictionary</a>
<a href="data_dict.html">Data Dictionary</a>
</div>
</div>
<a href="https://github.com/dghi-biostat/biostatlab">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Lab 1 (707)</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p><strong>Due:</strong> February 25, 2022 by 14:00 ET</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#lab-materials">LAB MATERIALS</a>
<ul>
<li><a href="#lab-1-goals">Lab 1 Goals</a></li>
<li><a href="#data-and-assignment">Data and assignment</a></li>
<li><a href="#lab-1-grading-scheme">Lab 1 Grading scheme</a></li>
<li><a href="#packages">Packages</a></li>
</ul></li>
<li><a href="#competencies">Competencies:</a>
<ul>
<li><a href="#import-data-from-.csv">Import data from
<code>.csv</code></a>
<ul>
<li><a href="#comma-separated-values-.csv">Comma separated values
(<code>.csv</code>)</a></li>
<li><a href="#import-from-.csv-read.csv">Import from .csv
(<code>read.csv()</code>)</a></li>
</ul></li>
<li><a href="#plots-with-ggplot2">Plots with {ggplot2}</a>
<ul>
<li><a href="#histograms-geom_histogram">Histograms
(<code>geom_histogram()</code>)</a></li>
<li><a href="#scatter-plots-geom_point">Scatter plots
(<code>geom_point()</code>)</a></li>
<li><a href="#q-q-plots-qqnorm">Q-Q Plots
(<code>qqnorm()</code>)</a></li>
<li><a href="#note-on-q-q-plots">Note on Q-Q Plots</a></li>
</ul></li>
<li><a href="#creating-new-variables">Creating new variables</a>
<ul>
<li><a href="#log-transform"><code>log()</code> transform</a></li>
<li><a href="#squaring-with-2">Squaring with <code>^2</code></a></li>
<li><a href="#categorical-variables-with-case_when">Categorical
variables with <code>case_when()</code></a></li>
</ul></li>
<li><a href="#skewness-and-kurtosis-moments-package">Skewness and
Kurtosis ({moments} package)</a></li>
<li><a
href="#pearson-and-spearman-rank-correlation-coefficients">Pearson and
Spearman rank correlation coefficients</a>
<ul>
<li><a href="#bonus-correlation-coefficient-matrices"><em>Bonus:</em>
Correlation coefficient matrices</a></li>
</ul></li>
<li><a href="#linear-regression-models">Linear Regression Models</a>
<ul>
<li><a href="#univariate-single-variable-models-with-lm">Univariate
(single-variable) models with <code>lm()</code></a></li>
<li><a href="#multivariable-models-with-lm">Multivariable models with
<code>lm()</code></a></li>
<li><a href="#linear-models-a-brief-tour">Linear models: a brief
tour</a></li>
</ul></li>
<li><a href="#plotting-line-of-best-fit">Plotting line of best fit</a>
<ul>
<li><a href="#model-first-then-plot">Model first, then plot</a></li>
<li><a href="#plot-first-then-model">Plot first, then model</a></li>
</ul></li>
<li><a href="#model-evaluation">Model Evaluation</a>
<ul>
<li><a href="#residuals-plots">Residuals plots</a></li>
<li><a href="#heteroskedasticity">Heteroskedasticity</a></li>
</ul></li>
<li><a href="#model-comparison">Model comparison</a>
<ul>
<li><a href="#f-test">F-test</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h2 id="lab-materials">LAB MATERIALS</h2>
<h3 id="lab-1-goals">Lab 1 Goals</h3>
<ul>
<li>Estimate crude measures of (linear) association using univariable
linear regression models<br />
</li>
<li>Estimate crude measures of non-linear association using univariable
linear regression models with linear transformed and categorical
variables.<br />
</li>
<li>Estimate adjusted measures of association using multivariable linear
regression models</li>
</ul>
<h3 id="data-and-assignment">Data and assignment</h3>
<p>The assignment and dataset are both available on <a
href="sakai.duke.edu">Sakai</a>.</p>
<h3 id="lab-1-grading-scheme">Lab 1 Grading scheme</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Competency</th>
<th style="text-align: center;">Points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Table 1a - Pearson CC</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Table 1b - Spearman rank CC</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Table 2 - Univariate models</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Table 3 - F Statistic</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Task 4 - Multivariable models</td>
<td style="text-align: center;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Figures</td>
<td style="text-align: center;">15 (1 point each)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Short answers 1 - 7</td>
<td style="text-align: center;">56 (8 points each)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Total</strong></td>
<td style="text-align: center;"><strong>100</strong></td>
</tr>
</tbody>
</table>
<h3 id="packages">Packages</h3>
<ul>
<li>{moments}</li>
<li>{car}</li>
<li>{tidyverse}</li>
</ul>
<h1 id="competencies">Competencies:</h1>
<h2 id="import-data-from-.csv">Import data from <code>.csv</code></h2>
<h3 id="comma-separated-values-.csv">Comma separated values
(<code>.csv</code>)</h3>
<p>CSV stands for “comma separated values”. It’s a way of organizing
data. When a file extension reads <code>.csv</code>, spreadsheet
applications like Excel understand that to mean that the data are stored
according to a simple set of rules.</p>
<p>See if you can spot the pattern.</p>
<p>The raw data might look like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Name, Date, App, date location, date ranking, second date</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>John, <span class="dv">01-19-2019</span>, Bumble, sip and paint, <span class="dv">7</span>, <span class="dv">0</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Niko, <span class="dv">02-14-2019</span>, Hinge, sky diving, <span class="dv">10</span>, <span class="dv">0</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Arwin, <span class="dv">02-28-2019</span>, Bumble, ice skating, <span class="dv">8</span>, <span class="dv">0</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Chad, <span class="dv">03-12-2019</span>, Tinder, movie night, <span class="dv">4</span>, <span class="dv">0</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Oleksiy, <span class="dv">03-15-2019</span>, Bumble, axe throwing, <span class="dv">8</span>, <span class="dv">0</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Manuel, <span class="dv">03-19-2019</span>, Bumble, bike ride, <span class="dv">9</span>, <span class="dv">0</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Vince, <span class="dv">03-27-2019</span>, Ship, barcade, <span class="dv">7</span>, <span class="dv">0</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Adamu, <span class="dv">04-01-2019</span>, Hinge, botanical garden, <span class="fl">8.5</span>, <span class="dv">0</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>Ryan, <span class="dv">04-21-2019</span>, Christian mingle, mass, <span class="fl">7.5</span>, <span class="dv">0</span></span></code></pre></div>
</div>
<p>And a spreadsheet application (e.g. Microsoft Excel) would display
the data like this: <img src="images/lab01_datedata.png"
alt="Dating Data" /></p>
<p>Which in R Studio, would look like this:</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 14%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 16%" />
<col style="width: 15%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Name</th>
<th style="text-align: left;">Date</th>
<th style="text-align: left;">App</th>
<th style="text-align: left;">date location</th>
<th style="text-align: right;">date ranking</th>
<th style="text-align: right;">second date</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">John</td>
<td style="text-align: left;">01-19-2019</td>
<td style="text-align: left;">Bumble</td>
<td style="text-align: left;">sip and paint</td>
<td style="text-align: right;">6.9</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Niko</td>
<td style="text-align: left;">02-14-2019</td>
<td style="text-align: left;">Hinge</td>
<td style="text-align: left;">sky diving</td>
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Arwin</td>
<td style="text-align: left;">02-28-2019</td>
<td style="text-align: left;">Bumble</td>
<td style="text-align: left;">ice skating</td>
<td style="text-align: right;">8.2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chad</td>
<td style="text-align: left;">03-12-2019</td>
<td style="text-align: left;">Tinder</td>
<td style="text-align: left;">movie night</td>
<td style="text-align: right;">4.4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oleksiy</td>
<td style="text-align: left;">03-15-2019</td>
<td style="text-align: left;">Bumble</td>
<td style="text-align: left;">axe throwing</td>
<td style="text-align: right;">8.3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Manuel</td>
<td style="text-align: left;">03-19-2019</td>
<td style="text-align: left;">Bumble</td>
<td style="text-align: left;">bike ride</td>
<td style="text-align: right;">8.9</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vince</td>
<td style="text-align: left;">03-27-2019</td>
<td style="text-align: left;">Ship</td>
<td style="text-align: left;">barcade</td>
<td style="text-align: right;">7.3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Adamu</td>
<td style="text-align: left;">04-01-2019</td>
<td style="text-align: left;">Hinge</td>
<td style="text-align: left;">botanical garden</td>
<td style="text-align: right;">8.5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ryan</td>
<td style="text-align: left;">04-21-2019</td>
<td style="text-align: left;">Christian mingle</td>
<td style="text-align: left;">mass</td>
<td style="text-align: right;">7.5</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<details>
<summary>
Expand for the four simple rules of .csv data
</summary>
<ul>
<li><p>commas delineate columns</p></li>
<li><p>a new line delineates a new row</p></li>
<li><p>the first row of data determines column names and number of
columns</p></li>
<li><p>the values between commas are data</p></li>
</ul>
</details>
<h3 id="import-from-.csv-read.csv">Import from .csv
(<code>read.csv()</code>)</h3>
<p><code>read.csv()</code> works a lot like <code>readRDS()</code>,
except it can interact with .csv files.</p>
<p>Before you try to import your data, do yourself a favor and open the
.csv file in Excel to inspect it.</p>
<figure>
<img src="images/lab01_regdat.png"
alt="The first 10 rows of regdat.csv" />
<figcaption aria-hidden="true">The first 10 rows of
<code>regdat.csv</code></figcaption>
</figure>
<p>Now that you’ve done that, note that <code>read.csv()</code> allows
the following arguments relevant to importing this lab’s data:</p>
<ul>
<li><code>file = ""</code> - just like <code>readRDS</code>, you need to
provide a file name in quotes</li>
<li><code>header =</code> - this argument takes either <code>TRUE</code>
or <code>FALSE</code>. If set to <code>TRUE</code>, the function will
use the first row of the data as the column names (“headers”)</li>
<li><code>col.names = c()</code> - takes a vector that is the same
length as the number of columns in the dataset. It will use the values
in this vector as the column names.</li>
</ul>
<p>Here is an example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.csv</a></span><span class='op'>(</span><span class='st'>"regdat.csv"</span>, header <span class='op'>=</span> <span class='cn'>FALSE</span>, 
                 col.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"columnA"</span>, <span class='st'>"columnB"</span>, <span class='st'>"columnC"</span>, <span class='st'>"columnD"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<aside>
<strong>Don’t forget</strong> to use <code>&lt;-</code> to assign a name
to your imported data frame!
</aside>
<h2 id="plots-with-ggplot2">Plots with {ggplot2}</h2>
<h3 id="histograms-geom_histogram">Histograms
(<code>geom_histogram()</code>)</h3>
<p>If you need a refresher on creating histograms with {ggplot2}, you
can find it <a
href="https://dghi-biostat.github.io/biostatlab/help_ggplot2.html#create-a-histogram-with-geom_histogram">here</a>.</p>
<h3 id="scatter-plots-geom_point">Scatter plots
(<code>geom_point()</code>)</h3>
<p>We create scatter plots by assigning an <code>x</code> and
<code>y</code> aesthetic (<code>aes()</code>) to a ggplot object, and
then adding a layer called <code>geom_point()</code></p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<h3 id="q-q-plots-qqnorm">Q-Q Plots (<code>qqnorm()</code>)</h3>
<p>A Q-Q plot allows us to compare a variable’s observed distribution
against its “theoretical” distribution. It does this by taking a
continuous variable, converting each value to a Z-score (using the
variable’s mean and standard deviation), and then plotting the Z-score
against the original observed value.</p>
<p>To do this in R, we might start by creating a <code>qqnorm</code>
object using <code>qqnorm()</code>:</p>
<p>As an example, here are first 10 values of
<code>regdat$weight</code>. “Observed Values” are the actual data, and
“Z-values” are the Z-score for each of those values of
<code>weight</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Observed Values</th>
<th style="text-align: right;">Z Values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">85.0</td>
<td style="text-align: right;">-0.6979123</td>
</tr>
<tr class="even">
<td style="text-align: right;">105.0</td>
<td style="text-align: right;">0.1272606</td>
</tr>
<tr class="odd">
<td style="text-align: right;">108.0</td>
<td style="text-align: right;">0.2675710</td>
</tr>
<tr class="even">
<td style="text-align: right;">92.0</td>
<td style="text-align: right;">-0.4018917</td>
</tr>
<tr class="odd">
<td style="text-align: right;">112.5</td>
<td style="text-align: right;">0.7389858</td>
</tr>
<tr class="even">
<td style="text-align: right;">112.0</td>
<td style="text-align: right;">0.4482006</td>
</tr>
<tr class="odd">
<td style="text-align: right;">104.0</td>
<td style="text-align: right;">0.0847131</td>
</tr>
<tr class="even">
<td style="text-align: right;">69.0</td>
<td style="text-align: right;">-1.9916133</td>
</tr>
<tr class="odd">
<td style="text-align: right;">94.5</td>
<td style="text-align: right;">-0.2348232</td>
</tr>
<tr class="even">
<td style="text-align: right;">68.5</td>
<td style="text-align: right;">-2.0751279</td>
</tr>
</tbody>
</table>
</div>
<p>We can use <code>qqnorm()</code> to calculate and plot these values
automatically!</p>
<p>Here is the Q-Q plot for <code>regdat$weight</code>, with histogram
for reference. Notice that the y-axis is labelled “Sample Quantiles” and
its range is the minimum and maximum weight in regdat, while the x-axis
is labelled “Theoretical Quantiles” and ranges from -3 to 3. <strong>Why
might that be?</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>weight</span>, main <span class='op'>=</span> <span class='st'>"Normal Q-Q Plot of Weight (lbs.)"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-7-1.png" width="50%" /><img src="707_lab_01_files/figure-html5/unnamed-chunk-7-2.png" width="50%" /></p>
</div>
<aside>
If <code>weight</code> were normally distributed, we would expect a
straight diagonal line. See the “Note on Q-Q plots” below for an example
of this.
</aside>
<h3 id="note-on-q-q-plots">Note on Q-Q Plots</h3>
<p>For a quick comparison, we can use a simple model to visualize how a
truly normal distribution would appear on a Q-Q plot:</p>
<aside>
<a
href="https://data.library.virginia.edu/understanding-q-q-plots/">This
page</a> from U Virginia is an excellent resource.
</aside>
<p>If we extract the mean and standard deviation from our height, we can
construct a normal distribution and plot it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># calculate mean of height</span>
<span class='va'>x_hat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>height</span><span class='op'>)</span>
<span class='co'># calculate sd of height</span>
<span class='va'>x_sd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>height</span><span class='op'>)</span>
<span class='co'># simulate a normal distribution using height's mean and sd</span>
<span class='va'>normal</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>500</span>, mean <span class='op'>=</span> <span class='va'>x_hat</span>, sd <span class='op'>=</span> <span class='va'>x_sd</span><span class='op'>)</span>
<span class='co'># scatter plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>normal</span><span class='op'>)</span>
<span class='co'># histogram</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>normal</span><span class='op'>)</span>
<span class='co'># Q-Q plot</span>
<span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>normal</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-8-1.png" width="33%" /><img src="707_lab_01_files/figure-html5/unnamed-chunk-8-2.png" width="33%" /><img src="707_lab_01_files/figure-html5/unnamed-chunk-8-3.png" width="33%" /></p>
</div>
<h4 id="bonus-qqnorm-but-with-ggplot">Bonus: <code>qqnorm()</code>, but
with <code>ggplot()</code></h4>
<p><strong>For those interested:</strong></p>
<p>Remember the discussion about how most objects contain more
information than initially meets the eye?</p>
<p>The same goes for <code>qqnorm</code> objects. They aren’t just a
bunch of dots. They contain vectors of the theoretical and observed
(“Sampled”) quantiles. If we convert the <code>qqnorm</code> object to a
<code>data.frame</code>, we can use <code>ggplot()</code> to call those
specific columns for plotting. Let’s look at how we would make a Q-Q
plot for the natural log of <code>weight</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># calculate ln_wt</span>
<span class='va'>regdat</span><span class='op'>$</span><span class='va'>ln_wt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>

<span class='co'># create qqnorm() object and convert to data.frame() object</span>
<span class='va'>qqnorm_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/qqnorm.html'>qqnorm</a></span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>ln_wt</span>, plot.it <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># plot in ggplot</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>qqnorm_data</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>"Q-Q plot for ln(weight)"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Theoretical Quantiles for ln_wt"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Sample Quantiles for ln_wt"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-9-1.png" width="50%" /></p>
</div>
<h2 id="creating-new-variables">Creating new variables</h2>
<h3 id="log-transform"><code>log()</code> transform</h3>
<p>In R, <code>log()</code> takes the natural log of a given value:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 2.302585</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#&gt; [1] 2.302585</span>
</code></pre>
</div>
</div>
<p>If given a vector of values, <code>log()</code> will take the natural
log of each of those values individually:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simple_vector</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>1000</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>simple_vector</span><span class='op'>)</span>

<span class='co'>#&gt; [1] 0.000000 2.302585 4.605170 6.907755</span>
</code></pre>
</div>
</div>
<p>Not relevant to Lab 01, but you can also specify what base you want
your log to be in with the argument <code>base =</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>simple_vector</span>, base <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>

<span class='co'>#&gt; [1] 0 1 2 3</span>
</code></pre>
</div>
</div>
<h4 id="why-do-a-log-transformation">Why do a log transformation?</h4>
<p>Imagine we have a variable that is highly right-skewed. The histogram
of that variable might look something like this:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>We can use a natural log transformation to make the variable’s
distribution more “normal”, and therefore suitable for linear
regression:</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-14-1.png" width="624" /></p>
</div>
<aside>
For more on transforming data into a normal distribution, see <a
href="https://www.datanovia.com/en/lessons/transform-data-to-normal-distribution-in-r/">this
link</a>
</aside>
<p>The natural log transformation uses ‘Euler’s number’ (2.718) as its
‘base’ (in contrast, a base 10 log transformation uses 10 as the base).
So:</p>
<p><span class="math display">\[
\begin{eqnarray}
ln(2) &amp;=&amp; 0.693\\
\rm{because} \ 2.718^.693 &amp;=&amp; 2
\end{eqnarray}
\]</span></p>
<p>Using a log transformation can help to ‘pull in’ outlier values,
which has the benefit of making the distribution more Normally
distributed and reduce skew, although it doesn’t affect kurtosis.</p>
<h3 id="squaring-with-2">Squaring with <code>^2</code></h3>
<p>In R, you can raise a base by any exponent using <code>^</code>. For
example, 10<sup>3</sup> would be written like this:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fl'>10</span><span class='op'>^</span><span class='fl'>3</span>

<span class='co'>#&gt; [1] 1000</span>
</code></pre>
</div>
</div>
<p>If you give R a vector of numbers, followed by an exponent, it will
perform the operation on each value individually:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>simple_vector</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>, <span class='fl'>3.3</span>, <span class='fl'>12</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>simple_vector</span><span class='op'>^</span><span class='fl'>2</span>

<span class='co'>#&gt; [1]   9.00  10.89 144.00   1.00</span>
</code></pre>
</div>
</div>
<aside>
<p>Recall that data frames are just lists of vectors!</p>
You might consider using <code>%&gt;%</code> and <a
href="https://dghi-biostat.github.io/biostatlab/lab_0.html#task-6-create-variable-mage"><code>mutate()</code></a>
to create a squared variable.
</aside>
<h3 id="categorical-variables-with-case_when">Categorical variables with
<code>case_when()</code></h3>
<p>For a refresher on how to generate categorical variables from
continuous variables, you can refer back to when we <a
href="https://dghi-biostat.github.io/biostatlab/lab_0.html#task-8-create-variable-magec"><strong>created
<code>magec</code></strong></a> in last 705, Lab 0.</p>
<h2 id="skewness-and-kurtosis-moments-package">Skewness and Kurtosis
({moments} package)</h2>
<p>In evaluating the skewness and kurtosis values, a variable that is
perfectly normally distributed will have a skewness of 0 and a kurtosis
of 3.</p>
<p>So for example, if a variable has a skewness of -0.05 and a kurtosis
of 2.2, we would conclude that the data are slightly left skewed
(negative value) and there is some kurtosis.</p>
<p>More specifically, because kurstosis, 2.2 &lt; 3, we conclude that
there are less data in the tails. If the value for kurtosis had been
greater than 3, we would have concluded that the variable has more data
in the tails than expected under a normal distribution.</p>
<aside>
<p><a
href="https://www.analyticsvidhya.com/blog/2021/05/shape-of-data-skewness-and-kurtosis/">Here
is a link</a> if you’d like to read more about it.</p>
</aside>
<p>In R, we can calculate both skewness and kurtosis using a package
called {moments} and its handy functions <code>skewness()</code> and
<code>kurtosis()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>skewness</span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>

<span class='fu'>kurtosis</span><span class='op'>(</span><span class='va'>regdat</span><span class='op'>$</span><span class='va'>weight</span><span class='op'>)</span>

<span class='co'>#&gt; [1] 0.5843876</span>
<span class='co'>#&gt; [1] 3.765937</span>
</code></pre>
</div>
</div>
<aside>
You will need to install {moments} with
<code>install.packages("moments")</code>
</aside>
<h2 id="pearson-and-spearman-rank-correlation-coefficients">Pearson and
Spearman rank correlation coefficients</h2>
<p>We use correlation coefficients to measure the strength and direction
of the linear association between two continuous variables.</p>
<p>Correlation coefficients can range from -1 to 1. Values closer to 1
represent a strong <strong>positive</strong> correlation. Those closer
to -1 represent a strong <strong>negative</strong> correlation. The
closer the correlation coefficient, R, is to 0, the weaker the
association between the two variables.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-18-1.png" width="33%" /><img src="707_lab_01_files/figure-html5/unnamed-chunk-18-2.png" width="33%" /><img src="707_lab_01_files/figure-html5/unnamed-chunk-18-3.png" width="33%" /></p>
</div>
<p>To calculate in R, use the function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(x, y, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="fu">c</span>(<span class="st">&quot;pearson&quot;</span>, <span class="st">&quot;kendall&quot;</span>, <span class="st">&quot;spearman&quot;</span>))<span class="st">`</span><span class="at"> </span></span></code></pre></div>
</div>
<p>Specify your x and y variables and set the method to your cheeky brit
of choice.</p>
<aside>
The <strong>Pearson</strong> is the parametric test. Both
<strong>Spearman</strong> and <strong>Kendall</strong> refer to
rank-based (non-parametric) measures of association for when our data
are non-normal.
</aside>
<p>If no method is specified, “pearson” is the default.</p>
<h3 id="bonus-correlation-coefficient-matrices"><em>Bonus:</em>
Correlation coefficient matrices</h3>
<p>If you want to have a very particular kind of fun, try the
following:</p>
<ol type="1">
<li>Take your <code>regdat</code> data and create a new data frame of
only continuous variables from <code>regdat</code>. Give it a new name,
like <code>cont_data</code>.<br />
</li>
<li>Use R to run <code>cor(cont_data)</code>, where the data frame of
continuous variable vectors is the only argument.</li>
</ol>
<aside>
You can use {dplyr}’s <code>select()</code> to <a
href="https://www.marsja.se/how-to-remove-a-column-in-r-using-dplyr-by-name-and-index/">remove
variables</a> by name. But there are also <a
href="https://statisticsglobe.com/r-remove-data-frame-columns-by-name">many</a>
<a
href="https://www.listendata.com/2015/06/r-keep-drop-columns-from-data-frame.html">many</a>
ways to do this.
</aside>
<p>What did it do? (Go look at Table 1 in the assignment.)</p>
<h2 id="linear-regression-models">Linear Regression Models</h2>
<p>Building models in R is fun!</p>
<h3 id="univariate-single-variable-models-with-lm">Univariate
(single-variable) models with <code>lm()</code></h3>
<p>Remember the concept of <a
href="https://www.datacamp.com/community/tutorials/r-formula-tutorial">R
formulas</a>?</p>
<p>Regression models make use of formulas in a very intuitive way. Here
is the general format:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>response_var</span> <span class='op'>~</span> <span class='va'>predictor_var</span>, data <span class='op'>=</span> <span class='va'>a_data_frame</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><code>lm</code> stands for “linear model”. If we assign a name to our
model, we can access various components within the model, which we can
index with <code>$</code>.</p>
<p>We can also just use <code>summary()</code> to view an overview of
the model’s most important components.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Length</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24675 -0.29657 -0.01515  0.27676  1.00269 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.30660    0.07839   54.94   &lt;2e-16 ***
Petal.Length  0.40892    0.01889   21.65   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4071 on 148 degrees of freedom
Multiple R-squared:   0.76, Adjusted R-squared:  0.7583 
F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<h3 id="multivariable-models-with-lm">Multivariable models with
<code>lm()</code></h3>
<p>You can also use <code>lm()</code> to program models with multiple
linear predictor variables. You can formulate your equation as you build
your model, using arithmetic operators on the right-hand side of the
formula:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>response_var</span> <span class='op'>~</span> <span class='va'>predictor_var1</span> <span class='op'>+</span> <span class='va'>predictor_var2</span>, data <span class='op'>=</span> <span class='va'>a_data_frame</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mlm1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>+</span> <span class='va'>Species</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>mlm1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length + Species, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.75310 -0.23142 -0.00081  0.23085  1.03100 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        3.68353    0.10610  34.719  &lt; 2e-16 ***
Petal.Length       0.90456    0.06479  13.962  &lt; 2e-16 ***
Speciesversicolor -1.60097    0.19347  -8.275 7.37e-14 ***
Speciesvirginica  -2.11767    0.27346  -7.744 1.48e-12 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.338 on 146 degrees of freedom
Multiple R-squared:  0.8367,    Adjusted R-squared:  0.8334 
F-statistic: 249.4 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<h3 id="linear-models-a-brief-tour">Linear models: a brief tour</h3>
<p>In this section, we’ll show you how to access a model’s coefficients,
confidence intervals, residuals, and other values that might come in
handy.</p>
<p>Remember how we said that you can extract numbers from your model
when you assign it a name? If we inspect <code>m1</code> using
<code>$</code> to index the object by name, we’ll see some useful items
at our disposal.</p>
<p>You can obtain the model’s coefficients with
<code>coef(your_model)</code>. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> (Intercept) Petal.Length 
   4.3066034    0.4089223 </code></pre>
</div>
<p>And you can calculate 95% confidence intervals with
<code>confint(your_model, level = 0.95)</code>. For example:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>m1</span>,  level <span class='op'>=</span> <span class='fl'>.95</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>                 2.5 %    97.5 %
(Intercept)  4.1516972 4.4615096
Petal.Length 0.3715907 0.4462539</code></pre>
</div>
<p>And don’t forget that you can inspect your model with
<code>summary()</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24675 -0.29657 -0.01515  0.27676  1.00269 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.30660    0.07839   54.94   &lt;2e-16 ***
Petal.Length  0.40892    0.01889   21.65   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4071 on 148 degrees of freedom
Multiple R-squared:   0.76, Adjusted R-squared:  0.7583 
F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Our model contains the columns of data (variables) used in its
calculation:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>$</span><span class='va'>model</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  Sepal.Length Petal.Length
1          5.1          1.4
2          4.9          1.4
3          4.7          1.3
4          4.6          1.5
5          5.0          1.4
6          5.4          1.7</code></pre>
</div>
<p>It also has the resulting fitted values:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>$</span><span class='va'>fitted.values</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>       1        2        3        4        5        6 
4.879095 4.879095 4.838202 4.919987 4.879095 5.001771 </code></pre>
</div>
<p>The fitted values are what result when we plug each row into the
model equation. We can use the first row of our data to observe this
directly:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>m1</span><span class='op'>$</span><span class='va'>model</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>]</span> <span class='co'># Petal.Length of row 1</span>

<span class='va'>B0</span> <span class='op'>&lt;-</span> <span class='va'>m1</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='co'># beta-naught</span>

<span class='va'>B1</span> <span class='op'>&lt;-</span> <span class='va'>m1</span><span class='op'>$</span><span class='va'>coefficients</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'># beta-one</span>

<span class='co'># formula:</span>
<span class='va'>fitted</span> <span class='op'>&lt;-</span> <span class='va'>B0</span> <span class='op'>+</span> <span class='va'>B1</span> <span class='op'>*</span> <span class='va'>x</span>
<span class='va'>fitted</span>
</code></pre>
</div>
<pre><code>(Intercept) 
   4.879095 </code></pre>
</div>
<p>The resulting value is the “fitted” value, or the estimate of the
response variable according to our model, given the value of the
predictor, <code>Petal.Length</code> (which for the first row in our
data, is 1.4).</p>
<p>Notice that our model also contains residuals, or the differences
between our observed values for y (our response variable), and the
values predicted by our model:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>$</span><span class='va'>residuals</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         1          2          3          4          5          6 
 0.2209054  0.0209054 -0.1382024 -0.3199868  0.1209054  0.3982287 </code></pre>
</div>
<p>We can find the first row’s residual value with the
<code>fitted</code> value that we calculated above:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># observed Sepal.Length of row 1 minus the predicted/fitted value:</span>
<span class='va'>m1</span><span class='op'>$</span><span class='va'>model</span><span class='op'>[</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>fitted</span>
</code></pre>
</div>
<pre><code>(Intercept) 
  0.2209054 </code></pre>
</div>
<h2 id="plotting-line-of-best-fit">Plotting line of best fit</h2>
<p>{ggplot2} provides a wide variety of flexible tools for visualizing
models. There are two main ways we might visualize a regression model.
The best way to do this is to fit the model and then plot the prediction
(often referred to as the line of best fit)</p>
<p>You can also use functions within {ggplot2} to generate a line of
best fit. This is a technique that we will encounter later in the
semester that is handy in special circumstances. But for now,
<strong>please use the method that follows</strong>.</p>
<aside>
<a
href="https://stats.idre.ucla.edu/r/faq/how-can-i-explore-different-smooths-in-ggplot2/"><strong>Here</strong></a>
is a highly useful tutorial for how to plot different models in
{ggplot2}. It includes splines, Loess, and multiple variations on
quadratics.
</aside>
<h3 id="model-first-then-plot">Model first, then plot</h3>
<p>We can plot our data and line of best fit by using a model as the
data object required by {ggplot2}.</p>
<p>Remember our example model from earlier:</p>
<div class="layout-chunk" data-layout="l-body">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24675 -0.29657 -0.01515  0.27676  1.00269 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.30660    0.07839   54.94   &lt;2e-16 ***
Petal.Length  0.40892    0.01889   21.65   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4071 on 148 degrees of freedom
Multiple R-squared:   0.76, Adjusted R-squared:  0.7583 
F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p><code>m1</code> will serve as our data object within
<code>ggplot()</code>. We can start by creating a scatter plot of the
response and predictor variables from our formula. But instead of using
the original data frame (<code>regdat</code>), we’ll use
<code>data = m1</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>m1</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Petal.Length</span>, y <span class='op'>=</span> <span class='va'>Sepal.Length</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>p</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<aside>
Notice that we have assigned a name to our plot, <code>p</code>. By
doing this, we can add layers to the original plot without needing to
reproduce the code each time.
</aside>
<p>From here, we can add a <code>geom_smooth()</code> layer to fit an
ordinary least squares regression line to our data. Notice that within
the model <code>m1</code>, we have access to a variable,
<code>.fitted</code>. We need to assign this to the y-axis of our plot.
This will plot a line for <code>Petal.Length</code> against our
fitted/predicted values!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y <span class='op'>=</span> <span class='va'>.fitted</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<p>Understanding how this method works will become more important as our
models increase in complexity. It also will helps in plotting residuals
(see <a
href="https://dghi-biostat.github.io/biostatlab/lab_01.html#residuals-plots">next
section</a>).</p>
<h3 id="plot-first-then-model">Plot first, then model</h3>
<p>To perform this method, we need to start with a scatter plot using
{ggplot2}:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>toy</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>ran1</span>, y <span class='op'>=</span> <span class='va'>pos</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Age (years)"</span>, y <span class='op'>=</span> <span class='st'>"Points"</span>, title <span class='op'>=</span> <span class='st'>"This is fake data"</span><span class='op'>)</span>

<span class='va'>p2</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<p>Once we have our plot, we just need to add another layer,
<code>stat_smooth()</code>, and designate a method and formula. Here,
we’re building a univariate, linear model. Observe how we parameterize
these details within the <code>stat_smooth()</code> function:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>stat_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-36-1.png" width="624" /></p>
</div>
<p>Notice that if we don’t designate a method,
<code>stat_smooth()</code> will default to plotting a smoothed “loess”
line, which we’ll learn more about later in the semester:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>p2</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>stat_smooth</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-37-1.png" width="624" /></p>
</div>
<p>For those curious, we can also print our model’s equation in the
plot. The code is a bit dense, but straightforward:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://docs.r4photobiology.info/ggpmisc/'>ggpmisc</a></span><span class='op'>)</span>

<span class='va'>p2</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>stat_smooth</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"lm"</span>, formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://docs.r4photobiology.info/ggpmisc/reference/stat_poly_eq.html'>stat_poly_eq</a></span><span class='op'>(</span>formula <span class='op'>=</span> <span class='va'>y</span> <span class='op'>~</span> <span class='va'>x</span>, 
                <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>..eq.label..</span>, 
                                  <span class='va'>..rr.label..</span>, 
                                  sep <span class='op'>=</span> <span class='st'>"~~~"</span><span class='op'>)</span><span class='op'>)</span>, 
                parse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-38-1.png" width="624" /></p>
</div>
<aside>
From <a
href="https://stackoverflow.com/questions/7549694/add-regression-line-equation-and-r2-on-graph">this
post</a> on SO.
</aside>
<h2 id="model-evaluation">Model Evaluation</h2>
<p>Once we’ve built a model, there are various measures we might use to
evaluate how well that model fits our data. Here we discuss two of those
measures: <strong>residuals</strong> and
<strong>heteroscedasticity</strong>.</p>
<h3 id="residuals-plots">Residuals plots</h3>
<p>Our model object contains a vector of residuals, which are the
observed Y minus the predicted Y:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>$</span><span class='va'>residuals</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>         1          2          3          4          5          6 
 0.2209054  0.0209054 -0.1382024 -0.3199868  0.1209054  0.3982287 </code></pre>
</div>
<p>We could generate a histogram of our residuals. In the following
code, notice that {ggplot2} finds our residuals when we refer to them as
<code>.resid</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://docs.r4photobiology.info/ggpp/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>m1</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>.resid</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_histogram.html'>geom_histogram</a></span><span class='op'>(</span>binwidth <span class='op'>=</span> <span class='fl'>.1</span>, fill <span class='op'>=</span> <span class='st'>"seagreen"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>'Residuals'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Histogram of residuals of Iris Petal Length regressed on Sepal Length"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-40-1.png" width="624" /></p>
</div>
<p>But we can also use that vector of residuals, <code>.resid</code> to
create a scatter plot of our fitted data against our residuals:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://docs.r4photobiology.info/ggpp/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>m1</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>.fitted</span>, y <span class='op'>=</span> <span class='va'>.resid</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"Fitted values"</span>, 
       y <span class='op'>=</span> <span class='st'>"Residuals"</span>, 
       title <span class='op'>=</span> <span class='st'>"Residual plot of iris petal length regressed on sepal length"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-41-1.png" width="624" /></p>
</div>
<aside>
Notice that we have added a dashed horizontal line at <code>y = 0</code>
by adding a layer to our plot:
<code>+ geom_hline(yintercept = 0, linetype = "dashed")</code>
</aside>
<p>This tells us if there is any bias in our model’s fit.</p>
<p>One such trend we might observe is heteroskedasticity,</p>
<h3 id="heteroskedasticity">Heteroskedasticity</h3>
<p>Simply put, heteroskedasticity is when the variability of Y (our
response variable) is different depending on X (our predictor
variable).</p>
<p>In the following plot, where along the x-axis would we be able to
accurately predict Y using a linear model?</p>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://docs.r4photobiology.info/ggpp/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>het</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>z</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"X"</span>, y <span class='op'>=</span> <span class='st'>"Y"</span>, title <span class='op'>=</span> <span class='st'>"More fake data"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="707_lab_01_files/figure-html5/unnamed-chunk-43-1.png" width="624" /></p>
</div>
<aside>
<a href="https://en.wikipedia.org/wiki/Heteroscedasticity">Wikipedia</a>
is telling me that this is Greek for “different” (<em>hetero</em>)
“dispersion” (<em>skedasis</em>)
</aside>
<p>The data above are
<strong>heteroskedastilisticexpialidocious.</strong></p>
<aside>
<a href="https://youtu.be/dQw4w9WgXcQ">Link, for the Disney lovers</a>
</aside>
<h4 id="breusch-pagancook-weisberg">Breusch-Pagan/Cook-Weisberg</h4>
<p>We can use a chi-squared test to assess <strong>how
heteroskedastic</strong> our data really are. We can do this using
<code>ncvTest()</code> from the package {car}.</p>
<p>Here’s a test of our iris model, whose residuals we visualized
above:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ncvTest</span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 2.493218, Df = 1, p = 0.11434</code></pre>
</div>
<aside>
For proof of method, see <a
href="https://www.rdocumentation.org/packages/car/versions/1.2-6/topics/ncv.test">“References”
section in documentation</a>
</aside>
<p>Meanwhile, here’s a Breusch-Pagan test of the heteroskedastilistic
data above. Notice the p-value:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ncvTest</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>z</span><span class='op'>~</span><span class='va'>x</span>, data <span class='op'>=</span> <span class='va'>het</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Non-constant Variance Score Test 
Variance formula: ~ fitted.values 
Chisquare = 27.79159, Df = 1, p = 1.3511e-07</code></pre>
</div>
<h2 id="model-comparison">Model comparison</h2>
<p>We can use an F-statistic to compare models when we add or omit
variables. Section 9.2 of OpenIntro contains a great introduction to
model selection. In it, they recommend two different model selection
strategies:</p>
<ol type="1">
<li><p><strong>Backwards elimination</strong> - where we generate a
fully saturated model, then take one variable out at a time.</p></li>
<li><p><strong>Forward selection</strong> - where we start with a single
predictor variable, and add one new variable at a time.</p></li>
</ol>
<p>With each step in either of these processes, we need some kind of
test to help us evaluate if the removal/addition of a variable has
<em>improved</em> the model.</p>
<p>In OpenIntro, they use R<sup>2</sup>. But we can also use an
F-test.</p>
<h3 id="f-test">F-test</h3>
<p>Use <code>anova(aModel, anotherModel)</code> to compute the
F-statistic for the comparison of two models.</p>
<p><a
href="https://dghi-biostat.github.io/biostatlab/lab_01.html#univariate-single-variable-models-with-lm">Further
up</a> on this page, we created a model that aimed to predict
<code>iris</code> sepal length using measures of iris petal length.</p>
<p>Here’s that model’s summary:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24675 -0.29657 -0.01515  0.27676  1.00269 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   4.30660    0.07839   54.94   &lt;2e-16 ***
Petal.Length  0.40892    0.01889   21.65   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4071 on 148 degrees of freedom
Multiple R-squared:   0.76, Adjusted R-squared:  0.7583 
F-statistic: 468.6 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>We may wonder if using a quadratic formula renders a better
model:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m1_quadratic</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>Sepal.Length</span> <span class='op'>~</span> <span class='va'>Petal.Length</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/AsIs.html'>I</a></span><span class='op'>(</span><span class='va'>Petal.Length</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>iris</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>m1_quadratic</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
lm(formula = Sepal.Length ~ Petal.Length + I(Petal.Length^2), 
    data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.0684 -0.2348  0.0121  0.2049  0.9146 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        5.05833    0.14036  36.038  &lt; 2e-16 ***
Petal.Length      -0.16435    0.09427  -1.743   0.0834 .  
I(Petal.Length^2)  0.08146    0.01318   6.181 5.96e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.3639 on 147 degrees of freedom
Multiple R-squared:  0.8095,    Adjusted R-squared:  0.8069 
F-statistic: 312.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<p>Compare the two outputs and notice that our Adjusted R-squared has
increased. This is a good sign.</p>
<p>But an F-statistic quantifies the difference in model fit between two
models:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>m1</span>, <span class='va'>m1_quadratic</span>, test <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Analysis of Variance Table

Model 1: Sepal.Length ~ Petal.Length
Model 2: Sepal.Length ~ Petal.Length + I(Petal.Length^2)
  Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    
1    148 24.525                                  
2    147 19.466  1    5.0593 38.206 5.955e-09 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<aside>
If you want to know more about how this test is performed, <a
href="https://stats.libretexts.org/Bookshelves/Applied_Statistics/Book%3A_Learning_Statistics_with_R_-_A_tutorial_for_Psychology_Students_and_other_Beginners_(Navarro)/16%3A_Factorial_ANOVA/16.05%3A_The___F___test_as_a_model_comparison">this
article</a> by Danielle Navarro is a great place to look.
</aside>
<p>The main thing of importance when performing an F-test on two models
is that the smaller of the two models (the “null” model) cannot contain
variables that are not in the larger model (the “alternative” or “full”
model).</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<div class="distill-site-nav distill-site-footer">
<p>GLHLTH 705 &amp; 707 lab materials adapted to R from original labs
written by Dr. Larry Park, Dr. Joseph Egger, Dr. Brian Pence, and Dr.
Daniel Westreich</p>
<p>Materials and website built using R version 4.1.0 and R Studio
v1.4.1717</p>
<p>Llama PNG Designed By andypp at
<a href='https://pngtree.com/so/llama'>PNG Tree</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->


</body>

</html>
